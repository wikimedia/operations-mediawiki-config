{
	"type": "record",
	"name": "CirrusSearchRequestSet",
	"namespace": "org.wikimedia.mediawiki.search",
	"doc": "A set of requests made by CirrusSearch to the elasticsearch user for a single php execution context",
	"fields": [
		{
			"name": "wikiId",
			"doc": "The wiki making this request, such as dewiki or enwiktionary",
			"type": "string",
			"default": ""
		},
		{
			"name": "source",
			"doc": "Where the request is coming from. Typically: web, api or cli",
			"type": "string",
			"default": ""
		},
		{
			"name": "identity",
			"doc": "A hash identifying the requestor. Includes the IP address and User Agent when available.",
			"type": "string",
			"default": ""
		},
		{
			"name": "ip",
			"doc": "The IP address (either ipv4 or ipv6) in string notation",
			"type": "string",
			"default": ""
		},
		{
			"name": "userAgent",
			"doc": "The HTTP User-Agent header, or null if not-applicable",
			"type": "string",
			"default": ""
		},
		{
			"name": "backendUserTests",
			"doc": "List of backend tests the requests are participating in",
			"type": { "type": "array","items":"string" },
			"default": []
		},
		{
			"name": "requests",
			"doc": "A list of requests made between mediawiki and elasticsearch in a single execution context",
			"default": [],
			"type": {
				"type": "array",
				"items": {
					"name": "CirrusSearchRequest",
					"namespace": "org.wikimedia.mediawiki.search",
					"doc": "An individual request made between mediawiki and elasticsearch",
					"type": "record",
					"fields": [
						{
							"name": "query",
							"doc": "The actual search request",
							"type": "string",
							"default": ""
						},
						{
							"name": "queryType",
							"doc": "The general type of query performed, such as full_text, prefix, etc.",
							"type": "string",
							"default": ""
						},
						{
							"name": "indices",
							"doc": "The list of indices the request was performed against",
							"type":{"type ": "array","items":"string"},
							"default": []
						},
						{
							"name": "tookMs",
							"doc": "The number of milliseconds between passing the query to the client library and getting the response back in the application",
							"type": "int",
							"default": -1
						},
						{
							"name": "elasticTookMs",
							"doc": "The number of milliseconds the query took, according to the elasticsearch response",
							"type": "int",
							"default": -1
						},
						{
							"name": "limit",
							"doc": "The maximum number of results requested by the application",
							"type": "int",
							"default": -1
						},
						{
							"name": "hitsTotal",
							"doc": "The approximate total number of documents matching the query",
							"type": "int",
							"default": -1
						},
						{
							"name": "hitsReturned",
							"doc": "The number of results returned to the application",
							"type": "int",
							"default": -1
						},
						{
							"name": "hitsOffset",
							"doc": "The offset of the query",
							"type": "int",
							"default": -1
						},
						{
							"name": "namespaces",
							"doc": "Each element is a mediawiki namespace id that was searched.",
							"type": {"type": "array","items":"int"},
							"default": []
						},
						{
							"name": "suggestion",
							"doc": "The suggestion generated by elasticsearch, or null if not requested",
							"type": "string",
							"default": ""
						},
						{
							"name": "suggestionRequested",
							"doc": "Indicates if elasticsearch was asked to provide a suggestion",
							"type": "boolean",
							"default": false
						}
					]
				}
			}
		}
	]
}
