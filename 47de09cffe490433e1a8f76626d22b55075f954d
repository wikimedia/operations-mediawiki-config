{
  "comments": [
    {
      "key": {
        "uuid": "1eadf644_d676956a",
        "filename": "wmf-config/logging.php",
        "patchSetId": 1
      },
      "lineNbr": 136,
      "author": {
        "id": 1001
      },
      "writtenOn": "2018-11-08T18:34:37Z",
      "side": 1,
      "message": "It may be slightly faster to use `defined( \u0027HHVM_VERSION\u0027 )` directly here rather than that helper function. This code can end up being many times during a normal web request, especially if there is a debug level handler enabled for some reason like when there is an \"X-WikiMedia-Debug: log\" header in the request.\n\nCloud just do something like:\n\n  $record[\u0027extra\u0027][\u0027php\u0027] \u003d defined( \u0027HHVM_VERSION\u0027 ) ? \u0027HHVM\u0027 : \u0027PHP\u0027 . PHP_MAJOR_VERSION . \u0027.\u0027 . PHP_MINOR_VERSION;",
      "revId": "47de09cffe490433e1a8f76626d22b55075f954d",
      "serverId": "e9e9afe9-4712-486d-8885-f54b72dd1951",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "92319aa4_644be4d7",
        "filename": "wmf-config/logging.php",
        "patchSetId": 1
      },
      "lineNbr": 136,
      "author": {
        "id": 458
      },
      "writtenOn": "2018-11-09T17:13:12Z",
      "side": 1,
      "message": "Ack. If we want to optimize away function calls, would it make sense to combine the three factory closures then (normalized_message, shard, php)?",
      "parentUuid": "1eadf644_d676956a",
      "revId": "47de09cffe490433e1a8f76626d22b55075f954d",
      "serverId": "e9e9afe9-4712-486d-8885-f54b72dd1951",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "336fa928_1701e490",
        "filename": "wmf-config/logging.php",
        "patchSetId": 1
      },
      "lineNbr": 136,
      "author": {
        "id": 221
      },
      "writtenOn": "2018-11-09T20:14:06Z",
      "side": 1,
      "message": "Would it help to calculate $version before line 135, and have line 135 be\n\n return function ( array $record ) use ( $version ) {\n\n?",
      "parentUuid": "92319aa4_644be4d7",
      "revId": "47de09cffe490433e1a8f76626d22b55075f954d",
      "serverId": "e9e9afe9-4712-486d-8885-f54b72dd1951",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "a8079e79_807ccc54",
        "filename": "wmf-config/logging.php",
        "patchSetId": 1
      },
      "lineNbr": 136,
      "author": {
        "id": 1001
      },
      "writtenOn": "2018-11-09T20:33:35Z",
      "side": 1,
      "message": "That could make a tiny bit of difference, yes. I started thinking about the use of wfIsHHVM() because I wondered if there was a code path that would lead to a log event being emitted before GlobalFunctions.php was read. I think I convinced myself that would not be possible, but then decided to add the micro optimization comment anyway. ;)",
      "parentUuid": "92319aa4_644be4d7",
      "revId": "47de09cffe490433e1a8f76626d22b55075f954d",
      "serverId": "e9e9afe9-4712-486d-8885-f54b72dd1951",
      "unresolved": false
    }
  ]
}